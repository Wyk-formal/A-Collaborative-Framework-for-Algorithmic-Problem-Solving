{% extends "base.html" %}

{% block title %}题目输入 - 算法竞赛RAG助手{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <!-- 左侧：题目输入 -->
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-edit"></i>
                        题目输入
                    </h5>
                </div>
                <div class="card-body">
                    <form id="problemForm">
                        <div class="mb-3">
                            <label for="problemContent" class="form-label">题目内容</label>
                            <textarea id="problemContent" name="problem_content" 
                                     class="form-control" rows="15" 
                                     placeholder="请输入完整的算法题目，包括题目描述、输入输出格式、样例等..."></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" 
                                       id="enableValidation" name="enable_validation" checked>
                                <label class="form-check-label" for="enableValidation">
                                    启用代码自动验证
                                </label>
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg" id="solveBtn">
                                <i class="fas fa-play"></i>
                                开始解题
                            </button>
                            <button type="button" class="btn btn-secondary" id="clearBtn">
                                <i class="fas fa-trash"></i>
                                清空内容
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- 示例题目 -->
            <div class="card mt-3">
                <div class="card-header">
                    <h6 class="card-title mb-0">
                        <i class="fas fa-lightbulb"></i>
                        示例题目
                    </h6>
                </div>
                <div class="card-body">
                    <button type="button" class="btn btn-outline-primary btn-sm me-2 example-btn" 
                            data-example="dp">动态规划示例</button>
                    <button type="button" class="btn btn-outline-primary btn-sm me-2 example-btn" 
                            data-example="graph">图论示例</button>
                    <button type="button" class="btn btn-outline-primary btn-sm example-btn" 
                            data-example="greedy">贪心示例</button>
                </div>
            </div>
        </div>
        
        <!-- 右侧：处理状态和结果 -->
        <div class="col-lg-6">
            <!-- 处理状态 -->
            <div class="card" id="statusCard" style="display: none;">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-cog fa-spin"></i>
                        处理状态
                    </h5>
                </div>
                <div class="card-body">
                    <div class="progress mb-3">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" 
                             id="progressBar" role="progressbar" style="width: 0%"></div>
                    </div>
                    <div id="statusMessage" class="text-muted">准备中...</div>
                    
                    <div class="mt-3" id="stageIndicators">
                        <div class="stage-indicator" data-stage="analyzing">
                            <i class="fas fa-search"></i> 分析题目
                        </div>
                        <div class="stage-indicator" data-stage="searching">
                            <i class="fas fa-database"></i> 检索算法
                        </div>
                        <div class="stage-indicator" data-stage="generating">
                            <i class="fas fa-code"></i> 生成代码
                        </div>
                        <div class="stage-indicator" data-stage="validating">
                            <i class="fas fa-check"></i> 验证代码
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 结果展示 -->
            <div class="card" id="resultCard" style="display: none;">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-check-circle text-success"></i>
                        解答结果
                    </h5>
                </div>
                <div class="card-body">
                    <div id="resultContent">
                        <!-- 结果内容将通过JavaScript动态填充 -->
                    </div>
                </div>
            </div>
            
            <!-- 错误信息 -->
            <div class="card" id="errorCard" style="display: none;">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-exclamation-triangle text-danger"></i>
                        错误信息
                    </h5>
                </div>
                <div class="card-body">
                    <div id="errorContent" class="text-danger">
                        <!-- 错误内容 -->
                    </div>
                    <button type="button" class="btn btn-outline-secondary mt-3" id="retryBtn">
                        <i class="fas fa-redo"></i>
                        重试
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/problem_input.js') }}"></script>
<style>
.stage-indicator {
    padding: 8px 12px;
    margin: 4px 0;
    border-radius: 4px;
    background-color: #f8f9fa;
    border-left: 4px solid #dee2e6;
    transition: all 0.3s ease;
}

.stage-indicator.active {
    background-color: #e3f2fd;
    border-left-color: #2196f3;
    color: #1976d2;
}

.stage-indicator.completed {
    background-color: #e8f5e8;
    border-left-color: #4caf50;
    color: #2e7d32;
}

.stage-indicator i {
    margin-right: 8px;
}
</style>
{% endblock %}

